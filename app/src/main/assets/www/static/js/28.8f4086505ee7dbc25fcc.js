webpackJsonp([28],{CZox:function(e,t){},NxdT:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("jeaY"),n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("header",{staticClass:"header"},[s("ul",[s("li",{on:{click:e.back}},[s("router-link",{attrs:{to:"/grpay"}},[s("span",{},[e._v("<")])])],1),e._v(" "),s("li",[e._v("确认支付")]),e._v(" "),s("li")])]),e._v(" "),s("div",{staticClass:"main"},[s("p",[e._v("订单总额："),s("span",{staticClass:"allmo"},[e._v(e._s(e._f("keep")(e.money)))]),e._v(" 元")]),e._v(" "),s("p",[s("ul",[s("li",{directives:[{name:"show",rawName:"v-show",value:e.type,expression:"type"}],staticClass:"quanq"},[e._v("贡融劵："),s("span",[s("i",[e._v(e._s(e.tick))]),e._v(" 劵")])]),e._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:e.typp,expression:"typp"}],staticClass:"yuee"},[e._v("余额："),s("span",[s("i",[e._v(e._s(e.banl))]),e._v(" 元 ")])])])]),e._v(" "),s("p",{staticStyle:{color:"#0088cc"}},[s("span",{on:{click:e.threepay}},[e._v("钱不够？使用第三方支付")])]),e._v(" "),s("p",[s("input",{attrs:{type:"button",value:"立即付款"},on:{click:e.sure}})])]),e._v(" "),s("div",{staticClass:"password"},[s("div",{staticClass:"password_bottom"},[s("span",{on:{click:e.del}},[e._v("×")]),e._v(" "),s("p",{staticClass:"password_p"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.psd,expression:"psd"}],attrs:{type:"password",maxlength:"6",id:"psd",placeholder:"请输入支付密码"},domProps:{value:e.psd},on:{input:function(t){t.target.composing||(e.psd=t.target.value)}}})])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.bol,expression:"bol"}],staticClass:"msg"},[s("div",{staticClass:"succeed"},[s("h3",[e._v("提示")]),e._v(" "),s("p",[e._v("支付成功")]),e._v(" "),s("span",{on:{click:e.dell}},[e._v("确定")])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.three,expression:"three"}],staticClass:"msg three"},[s("div",{staticClass:"succeed three2"},[s("span",{on:{click:e.closethree}},[e._v("×")]),e._v(" "),s("h3",[e._v("选择支付方式")]),e._v(" "),s("p",{on:{click:e.alipay}},[e._v("支付宝支付")]),e._v(" "),s("p",{on:{click:e.wechatpay}},[e._v("微信支付")])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.phonety,expression:"phonety"}],staticClass:"msg"},[s("div",{staticClass:"succeed"},[s("h3",[e._v("提示")]),e._v(" "),s("p",[e._v(" "+e._s(e.phonetype2))]),e._v(" "),s("span",{on:{click:e.dell}},[e._v("确定")])])])])},staticRenderFns:[]};var a=function(e){s("CZox")},i=s("VU/8")(o.a,n,!1,a,"data-v-1cd2c013",null);t.default=i.exports},jeaY:function(e,t,s){"use strict";(function(e){var o=s("pFYg"),n=s.n(o),a=s("mvHQ"),i=s.n(a);t.a={name:"",data:function(){return{msg:"",money:"",banl:"",tick:"",type:!0,typp:!0,buserId:"",ordernum:"",three:!1,psd:"",phonn:"",usdd:"",bol:!1,phonety:!1,phonetype:"",phonetype2:""}},created:function(){var e=this;this.phonn=sessionStorage.getItem("phone"),this.$axios.get("user/api/user-annexes-getUserInfosByPhone/"+this.phonn).then(function(t){e.usdd=t.data.id}).catch(function(e){console.log(e)}),this.type=sessionStorage.getItem("changetype"),this.money=sessionStorage.getItem("monbumber"),this.banl=sessionStorage.getItem("balance"),this.tick=sessionStorage.getItem("ticket"),this.tick=Number(this.tick),this.money=Number(this.money),"false"==this.type?this.type=!1:this.type=!0,this.tick>this.money?this.typp=!1:this.typp=!0},filters:{keep:function(e){return(e=Number(e)).toFixed(2)}},methods:{back:function(){sessionStorage.removeItem("monbumber"),sessionStorage.removeItem("balance"),sessionStorage.removeItem("changetype"),sessionStorage.removeItem("ticket"),sessionStorage.removeItem("phone")},del:function(){e(".password").fadeOut(200)},closethree:function(){this.three=!1},dell:function(){var e={func:"closeCurrent",param:{finallyIndex:1}},t=navigator.userAgent,s=t.indexOf("Android")>-1||t.indexOf("Adr")>-1;!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.webkit.messageHandlers.GongrongAppModel.postMessage(e):s&&window.androidObject.JSCallAndroid(i()(e))},sure:function(){var t=this,s=t.money,o=t.tick,a=t.banl,i=t.usdd;console.log(void 0===s?"undefined":n()(s));parseInt(o),parseInt(a);if(1==t.type)if(console.log("允许贡融劵"),t.tick>=t.money){console.log("劵足够支付"),e(".password").fadeIn(300);var r=s.toString(),c=i.toString();console.log(r),console.log(void 0===r?"undefined":n()(r));var l={amount:s,balance:0,buserId:c,payment:0,ticket:s,type:3};console.log(l),this.$axios({method:"post",url:"order/api/face_orders/createOrder",data:l}).then(function(e){console.log(e),t.ordernum=e.request.response}).catch(function(e){console.log(e)})}else{console.log("组合支付");var d=(s-o).toFixed(2);if(Number(d)>Number(a))alert("当前支付方式不足以支付订单，请充值或使用第三方支付");else{e(".password").fadeIn(300);l={amount:s,balance:d,buserId:i,payment:0,ticket:o,type:3};this.$axios({method:"post",url:"order/api/face_orders/createOrder",data:l}).then(function(e){console.log(e),t.ordernum=e.request.response}).catch(function(e){console.log(e)})}}else if(console.log("不允许贡融劵"),s>a)alert("余额不足，请充值或使用第三方支付");else{console.log("余额可以支付"),e(".password").fadeIn(300);l={amount:s,balance:s,buserId:i,payment:0,ticket:0,type:1};this.$axios({method:"post",url:"order/api/face_orders/createOrder",data:l}).then(function(e){console.log(e),t.ordernum=e.request.response}).catch(function(e){console.log(e)})}},threepay:function(){this.three=!0},alipay:function(){var t=e(".allmo").text();console.log(t);var s={amount:t,buserId:this.usdd,payment:t,type:4};this.$axios({method:"post",url:"order/api/face_orders/createOrder",data:s}).then(function(e){var t={func:"pay",param:{payType:"Ali",orderStr:e.data}},s=navigator.userAgent,o=s.indexOf("Android")>-1||s.indexOf("Adr")>-1;!!s.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.webkit.messageHandlers.GongrongAppModel.postMessage(t):o&&window.androidObject.JSCallAndroid(i()(t))}).catch(function(e){console.log(e)}),this.three=!1},wechatpay:function(){var t=e(".allmo").text();console.log(t);var s={amount:t,buserId:this.usdd,payment:t,type:5};this.$axios({method:"post",url:"order/api/face_orders/createOrder",data:s}).then(function(e){var t={func:"pay",param:{payType:"Wechat",orderStr:e.data}},s=navigator.userAgent,o=s.indexOf("Android")>-1||s.indexOf("Adr")>-1;!!s.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.webkit.messageHandlers.GongrongAppModel.postMessage(t):o&&window.androidObject.JSCallAndroid(i()(t))}).catch(function(e){console.log(e)}),this.three=!1},payStatus:function(e,t){this.phonety=!0,this.phonetype=e,"success"==this.phonetype?this.phonetype2="支付成功":"cancel"==this.type?this.phonetype2="用户取消":"failed"==this.type?this.phonetype2="支付失败":"unknown"==this.type&&(this.phonetype2="未知状态")}},watch:{psd:function(e){var t=this;if(6==e.length){console.log(e);var s=e,o={orderNo:t.ordernum,password:s};console.log(o),this.$axios.post("wallet/api/wallets/balance/pay",o).then(function(e){console.log(e),console.log(e.status),"200"==e.status&&(t.bol=!0)}).catch(function(e){console.log(e);var t=e.response.data.title;alert(t)})}}}}}).call(t,s("7t+N"))}});